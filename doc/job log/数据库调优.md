### 数据库调优

数据库调优主要是在数据落盘到MySQL的时候, 对写入数据时候做的优化.

这里ADS层产生的报表RDD, 经过切分, 利用RDD的foreachPartition优化写入数据库的性能.

对写入数据库性能优化的一个大的思路是重写了Spark源码中的JdbcUtils.savePartition()方法, 

参照这个方法, 一个大的思路是禁止数据库事务的自动提交, 改为手动去控制数据的一个提交时机, 

设置一个阈值, 在分区中execute一定数据量的SQL, 当execute的数据超过这个阈值的时候, commit



具体实现: 









### 对待服务器重启的异常情况

如果数据库压力过大宕机, 进行服务器重启, 这时要保证数据库重启之后要能重新连接

